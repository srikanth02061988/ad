-- Create widgets for start_date and end_date
CREATE WIDGET DATE start_date DEFAULT '2023-01-01';
CREATE WIDGET DATE end_date DEFAULT '2023-12-31';

-- Modified query with date filter
SELECT 
    sessionId, 
    userId, 
    CAST(trace.value AS FLOAT) AS value
FROM 
    hive_metastore.default.rai_new_payload_v2
WHERE 
    traceType = 'metric' 
    AND trace.attribute = 'modelLatency'
    AND traceTime BETWEEN getArgument('start_date') AND getArgument('end_date');
